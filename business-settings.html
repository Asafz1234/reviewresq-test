<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ReviewResQ ‚Äì Business Settings</title>
  <link rel="icon" type="image/png" href="logo.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="dashboard.css" />
  <script src="/runtime-env.js"></script>
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-mark">RR</div>
        <div class="brand-name">ReviewResQ</div>
      </div>
      <nav class="global-nav" aria-label="Dashboard navigation">
        <a class="nav-tab" data-route="dashboard" href="dashboard.html"><span class="nav-icon">üè†</span><span>Overview</span></a>
        <a class="nav-tab" data-route="ask-reviews" href="ask-reviews.html"><span class="nav-icon">‚úâÔ∏è</span><span>Ask for reviews</span></a>
        <a class="nav-tab" data-route="inbox" href="feedback.html"><span class="nav-icon">üí¨</span><span>Customer Feedback</span></a>
        <a class="nav-tab" data-route="google-reviews" href="google-reviews.html"><span class="nav-icon">‚òÖ</span><span>Google Reviews</span></a>
        <a class="nav-tab" data-route="customers" href="customers.html"><span class="nav-icon">üë•</span><span>Customers</span></a>
        <a class="nav-tab" data-route="campaigns" href="campaigns.html"><span class="nav-icon">üì¢</span><span>Campaigns</span></a>
        <a class="nav-tab" data-route="funnel" href="funnel-settings.html"><span class="nav-icon">‚Üó</span><span>Review Funnel</span></a>
        <a class="nav-tab" data-route="links" href="links.html"><span class="nav-icon">üîó</span><span>Review Links</span></a>
        <a class="nav-tab" data-route="alerts" href="alerts.html"><span class="nav-icon">üîî</span><span>Alerts &amp; Notifications</span></a>
        <a class="nav-tab" data-route="ai-agent" href="ai-agent.html"><span class="nav-icon">ü§ñ</span><span>AI Phone Agent</span></a>
        <a class="nav-tab" data-route="ai-agent" href="ai-agent.html#pro-suite"><span class="nav-icon">‚ö°</span><span>Pro AI Suite</span></a>
        <a class="nav-tab" data-route="business-settings" href="business-settings.html"><span class="nav-icon">üé®</span><span>Business Settings</span></a>
        <a class="nav-tab" data-route="account" href="billing.html"><span class="nav-icon">üí≥</span><span>Account &amp; Billing</span></a>
      </nav>
      <div class="setup-status" id="setupStatus">Setup: checking‚Ä¶</div>
    </aside>

    <div class="main">
      <header class="topbar">
        <div class="topbar-title">Business Settings</div>
        <div class="topbar-right">
          <span class="badge" data-plan-label>Starter</span>
          <button class="btn btn-link" type="button" onclick="window.location.href='auth.html'">Log out</button>
        </div>
      </header>

      <div class="page-shell">
        <header class="page-header">
          <p class="page-title">Branding &amp; identity</p>
          <p class="page-subtitle">Update how your business appears in the portal and outgoing emails.</p>
        </header>

        <div class="notice" id="setupNotice" hidden>
          <div>
            <p class="card-title">Setup your business (1 minute)</p>
            <p class="card-subtitle">Add your business name and sender name to unlock sending review requests.</p>
          </div>
          <div class="button-row">
            <button class="btn btn-primary" id="saveAndReturn" type="button">Save and continue</button>
          </div>
        </div>

        <section class="card">
          <div class="card-header">
            <div>
              <p class="card-title">Brand profile</p>
              <p class="card-subtitle">Share a name, color, and logo so the portal always looks polished.</p>
            </div>
            <div class="button-row">
              <button id="toggleDiagnostics" class="btn btn-ghost" type="button">Troubleshoot (advanced)</button>
              <button id="saveBranding" class="btn btn-primary" type="button">Save changes</button>
            </div>
          </div>

          <div class="brand-layout">
            <div class="brand-form">
              <div class="form-grid">
                <label>
                  <span class="card-title">Business name</span>
                  <input id="businessNameInput" class="input" type="text" minlength="2" placeholder="Riverstone Quality Services" required />
                </label>
                <label>
                  <span class="card-title">Sender name</span>
                  <input id="senderNameInput" class="input" type="text" placeholder="Name customers see in emails" />
                </label>
                <div class="readonly-field">
                  <div class="readonly-label">
                    <span class="card-title">Support email</span>
                    <span class="badge pill muted">Managed</span>
                  </div>
                  <p id="supportEmailValue" class="readonly-value">support@reviewresq.com</p>
                  <p class="caption">This is the email customers can reply to (managed by ReviewResq).</p>
                </div>
                <div class="brand-color-field">
                  <div class="brand-color-header">
                    <div>
                      <span class="card-title">Brand color</span>
                      <p class="caption">This color is used for buttons and highlights your customers will see.</p>
                    </div>
                    <button id="resetColorButton" class="btn btn-outline" type="button">Use default</button>
                  </div>
                  <div class="color-picker-row">
                    <input id="brandColorInput" class="input" type="color" value="#2563eb" aria-label="Brand color" />
                    <span id="brandColorHex" class="color-hex">#2563EB</span>
                  </div>
                </div>
              </div>

              <div class="form-grid logo-grid">
                <label>
                  <span class="card-title">Logo</span>
                  <input id="logoInput" class="input" type="file" accept="image/png, image/jpeg, image/webp" />
                  <p class="caption">PNG/JPG/WebP, up to 2MB. Larger files will be optimized automatically.</p>
                  <div id="logoUploadStatus" class="upload-status" aria-live="polite"></div>
                </label>
                <div class="logo-preview" aria-live="polite">
                  <div class="card-title">Preview</div>
                  <div class="avatar" id="logoPreviewWrapper">
                    <img id="logoPreview" alt="Business logo preview" />
                  </div>
                  <div id="logoPreviewText" class="caption"></div>
                </div>
              </div>

              <div class="notice" id="statusMessage" aria-live="polite" hidden></div>
            </div>

            <div class="brand-preview" aria-live="polite">
              <div class="preview-card">
                <div class="preview-header">
                  <div class="preview-logo" id="previewLogoCircle">
                    <img id="previewLogo" alt="Preview logo" />
                  </div>
                  <div>
                    <p class="preview-title" id="previewBusinessName">Your business</p>
                    <p class="preview-subtitle">Customer-facing styling</p>
                  </div>
                </div>

                <div class="preview-stack">
                  <div class="preview-section">
                    <div class="preview-label">Email preview</div>
                    <div class="preview-email">
                      <div class="preview-email-header" id="previewEmailHeader">
                        <span id="previewSenderName">Sender name</span>
                        <span class="preview-email-address">support@reviewresq.com</span>
                      </div>
                      <div class="preview-email-body">
                        <div class="preview-email-subject" id="previewEmailSubject">We'd love your feedback</div>
                        <button class="btn preview-button" id="previewEmailButton" type="button" disabled>Leave a review</button>
                      </div>
                    </div>
                  </div>

                  <div class="preview-section">
                    <div class="preview-label">Portal preview</div>
                    <div class="preview-portal">
                      <p class="preview-portal-title" id="previewPortalTitle">Share your experience</p>
                      <button class="btn preview-button" id="previewPortalButton" type="button" disabled>Start</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="diagnostics" id="diagnosticsPanel" hidden>
                <div class="diagnostics-header">
                  <div>
                    <p class="card-title">Advanced diagnostics</p>
                    <p class="card-subtitle">Validate branding, email sender, and portal configuration.</p>
                  </div>
                  <button id="diagnosticsBtn" class="btn btn-outline" type="button">Run diagnostics</button>
                </div>
                <div class="diagnostics-body">
                  <pre id="diagnosticsOutput" class="diagnostics-output">Run diagnostics to see details here.</pre>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script src="dashboard-nav.js"></script>
  <script type="module" src="business-settings.js"></script>
</body>
</html>
