  <body>
    <div class="auth-shell">
      <div class="auth-card">
        <header class="brand">
          <div class="brand-icon">R</div>
          <div class="brand-text">
            <div class="brand-title">REVIEWRESQ</div>
            <div class="brand-sub">REVIEWS ¬∑ REPUTATION ¬∑ RESQ</div>
          </div>
        </header>

        <h1 class="auth-title">Welcome back</h1>
        <p class="auth-subtitle">
          Log in or create your ReviewResQ account.
        </p>

        <!-- Tabs -->
        <div class="auth-tabs">
          <button class="auth-tab active" data-target="login">Login</button>
          <button class="auth-tab" data-target="signup">Create account</button>
          <button class="auth-tab" data-target="forgot">Forgot password</button>
        </div>

        <!-- Global message (errors / success) -->
        <div id="global-message" class="global-message" role="alert"></div>

        <!-- LOGIN PANEL -->
        <section id="login-panel" class="auth-panel active" aria-label="Login">
          <form id="login-form">
            <div class="field">
              <label for="login-email">Work email</label>
              <input id="login-email" type="email" autocomplete="email" />
              <div id="login-email-error" class="field-error"></div>
            </div>

            <div class="field">
              <label for="login-password">Password</label>
              <input id="login-password" type="password" autocomplete="current-password" />
              <div id="login-password-error" class="field-error"></div>
            </div>

            <button type="submit" class="btn-primary" id="login-submit">
              Log in
            </button>
          </form>
        </section>

        <!-- SIGNUP PANEL -->
        <section id="signup-panel" class="auth-panel" aria-label="Create account">
          <form id="signup-form">
            <div class="field">
              <label for="signup-name">Full name</label>
              <input id="signup-name" type="text" autocomplete="name" />
              <div id="signup-name-error" class="field-error"></div>
            </div>

            <div class="field">
              <label for="signup-email">Business email</label>
              <input id="signup-email" type="email" autocomplete="email" />
              <div id="signup-email-error" class="field-error"></div>
            </div>

            <div class="field">
              <label for="signup-phone">Business phone</label>
              <input id="signup-phone" type="tel" autocomplete="tel" />
              <div id="signup-phone-error" class="field-error"></div>
            </div>

            <div class="field">
              <label for="signup-password">Password</label>
              <input id="signup-password" type="password" autocomplete="new-password" />
              <div class="field-hint">At least 6 characters.</div>
              <div id="signup-password-error" class="field-error"></div>
            </div>

            <button type="submit" class="btn-primary" id="signup-submit">
              Create account
            </button>
          </form>
        </section>

        <!-- FORGOT PASSWORD PANEL -->
        <section id="forgot-panel" class="auth-panel" aria-label="Forgot password">
          <form id="forgot-form">
            <div class="field">
              <label for="forgot-email">Work email</label>
              <input id="forgot-email" type="email" autocomplete="email" />
              <div id="forgot-email-error" class="field-error"></div>
            </div>

            <div class="field-hint">
              We‚Äôll send a reset link to this email if it has an account.
            </div>

            <button type="submit" class="btn-primary" id="forgot-submit">
              Send reset link
            </button>
          </form>
        </section>

        <div class="auth-footer">
          <span>‚Üê <a href="/index.html">Back to main site</a></span>
        </div>
      </div>
    </div>
<script type="module">
  import {
    auth,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    sendPasswordResetEmail,
  } from "./firebase.js";

  /* ---------------------------
     TAB SWITCHING
  ---------------------------- */
  const tabs = document.querySelectorAll(".auth-tab");
  const panels = document.querySelectorAll(".auth-panel");

  tabs.forEach((tab) => {
    tab.addEventListener("click", () => {
      tabs.forEach((t) => t.classList.remove("active"));
      panels.forEach((p) => p.classList.remove("active"));

      tab.classList.add("active");
      const target = tab.dataset.target;
      document.getElementById(`${target}-panel`).classList.add("active");

      clearGlobalMessage();
      clearAllErrors();
    });
  });

  /* ---------------------------
     GLOBAL HELPERS
  ---------------------------- */
  const globalMsg = document.getElementById("global-message");

  function showGlobalError(msg) {
    globalMsg.textContent = msg;
    globalMsg.className = "global-message visible error";
  }

  function showGlobalSuccess(msg) {
    globalMsg.textContent = msg;
    globalMsg.className = "global-message visible success";
  }

  function clearGlobalMessage() {
    globalMsg.textContent = "";
    globalMsg.className = "global-message";
  }

  function clearAllErrors() {
    document.querySelectorAll(".field-error").forEach((el) => (el.textContent = ""));
    document.querySelectorAll("input").forEach((i) => i.classList.remove("error"));
  }

  function fieldError(id, msg) {
    const input = document.getElementById(id);
    const errorDiv = document.getElementById(id + "-error");

    input.classList.add("error");
    errorDiv.textContent = msg;
  }

  /* ---------------------------
     LOGIN
  ---------------------------- */
  const loginForm = document.getElementById("login-form");

  loginForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    clearAllErrors();
    clearGlobalMessage();

    const email = document.getElementById("login-email").value.trim();
    const password = document.getElementById("login-password").value.trim();

    if (!email) return fieldError("login-email", "Email is required.");
    if (!password) return fieldError("login-password", "Password is required.");

    try {
      await signInWithEmailAndPassword(auth, email, password);

      showGlobalSuccess("Logged in! Redirecting...");

      setTimeout(() => {
        window.location.href = "/dashboard.html";
      }, 600);
    } catch (err) {
      if (err.code === "auth/invalid-credential") {
        showGlobalError("Incorrect email or password.");
      } else {
        showGlobalError("Login failed. Please try again.");
      }
    }
  });

  /* ---------------------------
     SIGNUP
  ---------------------------- */
  const signupForm = document.getElementById("signup-form");

  signupForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    clearAllErrors();
    clearGlobalMessage();

    const name = document.getElementById("signup-name").value.trim();
    const email = document.getElementById("signup-email").value.trim();
    const phone = document.getElementById("signup-phone").value.trim();
    const password = document.getElementById("signup-password").value.trim();

    if (!name) return fieldError("signup-name", "Full name is required.");
    if (!email) return fieldError("signup-email", "Email is required.");
    if (!phone) return fieldError("signup-phone", "Phone is required.");
    if (password.length < 6)
      return fieldError("signup-password", "Password must be at least 6 characters.");

    try {
      await createUserWithEmailAndPassword(auth, email, password);

      showGlobalSuccess("Account created! Redirecting...");

      // üî• redirect to onboarding
      setTimeout(() => {
        window.location.href = "/onboarding.html";
      }, 700);
    } catch (err) {
      if (err.code === "auth/email-already-in-use") {
        showGlobalError("This email already has an account.");
      } else if (err.code === "auth/invalid-email") {
        showGlobalError("Please enter a valid email.");
      } else {
        showGlobalError("Signup failed. Please try again.");
      }
    }
  });

  /* ---------------------------
     FORGOT PASSWORD
  ---------------------------- */
  const forgotForm = document.getElementById("forgot-form");

  forgotForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    clearAllErrors();
    clearGlobalMessage();

    const email = document.getElementById("forgot-email").value.trim();
    if (!email) return fieldError("forgot-email", "Email is required.");

    try {
      await sendPasswordResetEmail(auth, email);

      showGlobalSuccess("Reset link sent! Check your inbox.");
    } catch (err) {
      if (err.code === "auth/user-not-found") {
        showGlobalError("No account found with this email.");
      } else {
        showGlobalError("Couldn't send reset link. Try again.");
      }
    }
  });
</script>
